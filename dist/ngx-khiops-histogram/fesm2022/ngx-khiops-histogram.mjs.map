{"version":3,"file":"ngx-khiops-histogram.mjs","sources":["../../../projects/ngx-khiops-histogram/src/lib/model/ngx-khiops-histogram.types.ts","../../../projects/ngx-khiops-histogram/src/lib/services/ngx-khiops-histogram.ui.service.ts","../../../projects/ngx-khiops-histogram/src/lib/model/ngx-khiops-histogram.bar-vo.ts","../../../projects/ngx-khiops-histogram/src/lib/services/ngx-khiops-histogram.service.ts","../../../projects/ngx-khiops-histogram/src/lib/components/tooltip/ngx-khiops-histogram.tooltip.component.ts","../../../projects/ngx-khiops-histogram/src/lib/components/histogram/ngx-khiops-histogram.component.ts","../../../projects/ngx-khiops-histogram/src/lib/components/histogram/ngx-khiops-histogram.component.html","../../../projects/ngx-khiops-histogram/src/lib/ngx-khiops-histogram.module.ts","../../../projects/ngx-khiops-histogram/src/public-api.ts","../../../projects/ngx-khiops-histogram/src/ngx-khiops-histogram.ts"],"sourcesContent":["export enum HistogramType {\r\n  XLOG = 'xLog',\r\n  XLIN = 'xLin',\r\n  YLOG = 'yLog',\r\n  YLIN = 'yLin',\r\n}\r\n","import { Injectable } from '@angular/core';\r\n// import { TranslateService } from '@ngstack/translate';\r\nimport * as d3 from 'd3';\r\nimport { HistogramValuesI } from '../interfaces/ngx-khiops-histogram.interfaces';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class HistogramUIService {\r\n  static readonly chartColors: string[] = ['#6e93d5', '#ffbe46'];\r\n  // static translate: TranslateService;\r\n\r\n  static setTranslationService() {\r\n    // translate: TranslateService\r\n    // this.translate = translate;\r\n  }\r\n\r\n  static getColor(i: number): string {\r\n    return this.chartColors[i];\r\n  }\r\n\r\n  static getColors(): string[] {\r\n    return this.chartColors;\r\n  }\r\n\r\n  // @ts-ignore\r\n  static getCurrentBarPosition(\r\n    datas: HistogramValuesI[],\r\n    canvasPosition: DOMRect,\r\n    event: MouseEvent,\r\n    yPadding: number = 0\r\n  ) {\r\n    if (datas) {\r\n      let x = event.pageX - canvasPosition.left;\r\n      let y = event.pageY - canvasPosition.top;\r\n\r\n      for (let i = 0; i < datas.length; i++) {\r\n        if (\r\n          // @ts-ignore\r\n          y > datas?.[i].coords?.y &&\r\n          // @ts-ignore\r\n          y < datas?.[i].coords?.y + datas?.[i].coords?.barH + yPadding / 2 &&\r\n          // @ts-ignore\r\n          x > datas?.[i].coords?.x &&\r\n          // @ts-ignore\r\n          x < datas?.[i].coords?.x + datas?.[i].coords?.barW\r\n        ) {\r\n          return i;\r\n        }\r\n      }\r\n    }\r\n\r\n    return undefined;\r\n  }\r\n\r\n  static generateTooltip(\r\n    datasLabels: any,\r\n    d: HistogramValuesI,\r\n    isFirstInterval: boolean\r\n  ): string {\r\n    let bounds = '';\r\n    if (isFirstInterval) {\r\n      bounds += '[';\r\n    } else {\r\n      bounds += ']';\r\n    }\r\n    bounds += d.partition[0] + ', ' + d.partition[1] + ']';\r\n    return (\r\n      // this.translate.get('GLOBAL.DENSITY') +\r\n      datasLabels.value +\r\n      ': ' +\r\n      d3.format('.2e')(d.value) +\r\n      '<br>' +\r\n      // this.translate.get('GLOBAL.FREQUENCY') +\r\n      datasLabels.frequency +\r\n      ': ' +\r\n      d.frequency +\r\n      '<br>' +\r\n      // this.translate.get('GLOBAL.INTERVAL') +\r\n      datasLabels.partition +\r\n      ': ' +\r\n      bounds\r\n    );\r\n  }\r\n\r\n  static initCanvasContext(\r\n    canvas: HTMLCanvasElement | undefined | null,\r\n    w: number,\r\n    h: number\r\n  ) {\r\n    const ctx = canvas?.getContext('2d');\r\n    if (ctx && canvas) {\r\n      ctx.imageSmoothingEnabled = true;\r\n      canvas.width = w;\r\n      canvas.height = h;\r\n    }\r\n    return ctx;\r\n  }\r\n\r\n  /**\r\n   * Before draw canvas, clean dom\r\n   */\r\n  static cleanDomContext(\r\n    ctx: CanvasRenderingContext2D | undefined | null,\r\n    canvas: HTMLCanvasElement | undefined | null\r\n  ) {\r\n    if (canvas) {\r\n      // @ts-ignore\r\n      ctx = canvas.getContext('2d');\r\n      // @ts-ignore\r\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    }\r\n  }\r\n\r\n  static hexToRgba(hex: string, alpha: number) {\r\n    if (!/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\r\n      throw new Error('Invalid Hex format');\r\n    }\r\n    let c;\r\n    if (hex.length === 4) {\r\n      c = '#' + [hex[1], hex[1], hex[2], hex[2], hex[3], hex[3]].join('');\r\n    } else {\r\n      c = hex;\r\n    }\r\n    const r = parseInt(c.slice(1, 3), 16);\r\n    const g = parseInt(c.slice(3, 5), 16);\r\n    const b = parseInt(c.slice(5, 7), 16);\r\n    return `rgba(${r}, ${g}, ${b}, ${alpha})`;\r\n  }\r\n}\r\n","import { HistogramValuesI } from '../interfaces/ngx-khiops-histogram.interfaces';\r\nimport { HistogramType } from './ngx-khiops-histogram.types';\r\nimport { HistogramUIService } from '../services/ngx-khiops-histogram.ui.service';\r\n\r\nexport class HistogramBarVO {\r\n  barWlog: number = 0;\r\n  barXlog: number = 0;\r\n  barWlin: number = 0;\r\n  barXlin: number = 0;\r\n  color: string = HistogramUIService.getColor(1);\r\n  partition = [];\r\n\r\n  constructor(d: HistogramValuesI, middlewidth: number, xType: string) {\r\n    //@ts-ignore\r\n    this.partition = d.partition;\r\n    if (xType === HistogramType.XLIN) {\r\n      let barWlin = 0;\r\n      if (this.partition[0] < 0 && this.partition[1] > 0) {\r\n        barWlin = Math.abs(this.partition[0]) + Math.abs(this.partition[1]);\r\n      } else {\r\n        barWlin = Math.abs(this.partition[0]) - Math.abs(this.partition[1]);\r\n      }\r\n      this.barWlin = Math.abs(barWlin);\r\n    } else {\r\n      let barWlog = 0;\r\n      if (d.partition[0] === 0 || d.partition[1] === 0) {\r\n        barWlog = Math.log10(middlewidth);\r\n        this.color = HistogramUIService.getColor(0);\r\n      } else {\r\n        barWlog =\r\n          Math.log10(Math.abs(this.partition[0])) -\r\n          Math.log10(Math.abs(this.partition[1]));\r\n\r\n        if (this.partition[0] < 0 && this.partition[1] > 0) {\r\n          barWlog = Math.log10(middlewidth) * 2;\r\n          this.color = HistogramUIService.getColor(0);\r\n        }\r\n      }\r\n      this.barWlog = Math.abs(barWlog);\r\n    }\r\n  }\r\n\r\n  computeXLog(bars: HistogramBarVO[]) {\r\n    let sum = bars.reduce(\r\n      (partialSum: number, a: HistogramBarVO) =>\r\n        Math.abs(partialSum) + Math.abs(a.barWlog),\r\n      0\r\n    );\r\n    this.barXlog = sum || 0;\r\n  }\r\n\r\n  computeXLin(bars: HistogramBarVO[]) {\r\n    let sum = bars.reduce(\r\n      (partialSum: number, a: HistogramBarVO) =>\r\n        Math.abs(partialSum) + Math.abs(a.barWlin),\r\n      0\r\n    );\r\n    this.barXlin = sum || 0;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { HistogramBarVO } from '../model/ngx-khiops-histogram.bar-vo';\r\nimport { HistogramType } from '../model/ngx-khiops-histogram.types';\r\nimport {\r\n  HistogramValuesI,\r\n  RangeXLinI,\r\n  RangeXLogI,\r\n  RangeYLogI,\r\n} from '../interfaces/ngx-khiops-histogram.interfaces';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class HistogramService {\r\n  rangeXLin: RangeXLinI = {};\r\n  rangeYLin: number = 0;\r\n  rangeYLog: RangeYLogI = {\r\n    min: 0,\r\n    max: 0,\r\n  };\r\n  rangeXLog: RangeXLogI = {};\r\n\r\n  getRangeX(datas: HistogramValuesI[]): [RangeXLinI, RangeXLogI] {\r\n    this.rangeXLog.inf = datas.find(function (d: HistogramValuesI) {\r\n      return d.partition[0] === 0 || d.partition[1] === 0;\r\n    });\r\n\r\n    this.rangeXLog.min = datas[0].partition[0];\r\n    this.rangeXLog.negValuesCount = datas.filter(function (\r\n      d: HistogramValuesI\r\n    ) {\r\n      return d.partition[1] < 0;\r\n    })?.length;\r\n    this.rangeXLog.posValuesCount = datas.filter(function (\r\n      d: HistogramValuesI\r\n    ) {\r\n      return d.partition[1] > 0;\r\n    })?.length;\r\n    if (this.rangeXLog.inf) {\r\n      // 0 exist\r\n      this.rangeXLog.negStart =\r\n        // @ts-ignore update it with es2023\r\n        datas.findLast(function (d: HistogramValuesI) {\r\n          return d.partition[0] < 0 && d.partition[1] <= 0;\r\n        })?.partition[0] || undefined;\r\n      this.rangeXLog.posStart =\r\n        datas.find(function (d: HistogramValuesI) {\r\n          return d.partition[0] > 0 && d.partition[1] > 0;\r\n        })?.partition[0] || undefined;\r\n    } else {\r\n      this.rangeXLog.negStart =\r\n        // @ts-ignore update it with es2023\r\n        datas.findLast(function (d: HistogramValuesI) {\r\n          return d.partition[0] < 0 && d.partition[1] <= 0;\r\n        })?.partition[1] || undefined;\r\n      this.rangeXLog.posStart =\r\n        datas.find(function (d: HistogramValuesI) {\r\n          return d.partition[0] > 0 && d.partition[1] > 0;\r\n        })?.partition[0] || undefined;\r\n    }\r\n\r\n    this.rangeXLog.max = datas[datas.length - 1].partition[1];\r\n\r\n    this.rangeXLog.middlewidth = 1.2;\r\n\r\n    this.rangeXLin.min = datas[0].partition[0];\r\n    this.rangeXLin.max = datas[datas.length - 1].partition[1];\r\n\r\n    return [this.rangeXLin, this.rangeXLog];\r\n  }\r\n\r\n  getLinRangeY(datas: HistogramValuesI[]): number {\r\n    const dataValues = datas.map((d: HistogramValuesI) => d.value);\r\n    this.rangeYLin = Math.max(...dataValues);\r\n    return this.rangeYLin;\r\n  }\r\n\r\n  getLogRangeY(datas: HistogramValuesI[]): RangeXLinI {\r\n    const dataValues = datas.map((e) => e.logValue).filter((e) => e !== 0);\r\n\r\n    // Numerical histogram Ylog broken when only one data #194\r\n    this.rangeYLog.max = Math.max(...dataValues);\r\n    if (dataValues.length === 1) {\r\n      this.rangeYLog.min = 0;\r\n    } else {\r\n      this.rangeYLog.min = Math.min(...dataValues);\r\n    }\r\n\r\n    return this.rangeYLog;\r\n  }\r\n\r\n  getLinRatioY(h: number, padding: number = 0): number {\r\n    let ratioY = (h - padding / 2) / this.rangeYLin;\r\n    return ratioY;\r\n  }\r\n\r\n  getLogRatioY(h: number, padding: number = 0): number {\r\n    let ratioY;\r\n    // @ts-ignore\r\n    let shift = Math.abs(this.rangeYLog.min) - Math.abs(this.rangeYLog.max);\r\n    ratioY = (h - padding / 2) / shift;\r\n    return ratioY;\r\n  }\r\n\r\n  computeXbarsDimensions(\r\n    datas: HistogramValuesI[],\r\n    xType: string\r\n  ): HistogramBarVO[] {\r\n    let bars: HistogramBarVO[] = [];\r\n\r\n    datas.forEach((d: HistogramValuesI, i: number) => {\r\n      let histogramBar = new HistogramBarVO(\r\n        d,\r\n        // @ts-ignore\r\n        this.rangeXLog.middlewidth,\r\n        xType\r\n      );\r\n      if (xType === HistogramType.XLIN) {\r\n        histogramBar.computeXLin(bars);\r\n      } else {\r\n        histogramBar.computeXLog(bars);\r\n      }\r\n      bars.push(histogramBar);\r\n    });\r\n    return bars;\r\n  }\r\n}\r\n","import { Component, Input } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'ngx-khiops-histogram-tooltip',\r\n  template: `\r\n    <div\r\n      [ngStyle]=\"{\r\n        'left.px': this.computeXPos(),\r\n        'top.px': this.computeYPos()\r\n      }\"\r\n      class=\"tooltip\"\r\n      [style.display]=\"display ? 'block' : 'none'\"\r\n    >\r\n      <p [innerHTML]=\"text\"></p>\r\n    </div>\r\n  `,\r\n  styles: [\r\n    `\r\n      .tooltip {\r\n        font-family: verdana;\r\n        position: absolute;\r\n        background-color: rgba(0, 0, 0, 0.8);\r\n        color: #fff;\r\n        font-weight: 200;\r\n        z-index: 2;\r\n        padding: 0 10px;\r\n        border-radius: 5px;\r\n        font-size: 0.8rem;\r\n        pointer-events: none;\r\n      }\r\n    `,\r\n  ],\r\n  standalone: false,\r\n})\r\nexport class NgxKhiopsHistogramTooltipComponent {\r\n  @Input() text: string = '';\r\n  @Input() posX: number = 0;\r\n  @Input() posY: number = 0;\r\n  @Input() canvasW: number = 0;\r\n  @Input() display: boolean = false;\r\n\r\n  constructor() {}\r\n\r\n  computeYPos() {\r\n    let top = this.posY - 0;\r\n    if (top < 10) {\r\n      top = 10;\r\n    }\r\n    return top;\r\n  }\r\n\r\n  computeXPos() {\r\n    let left = this.posX + 20;\r\n    if (left < 10) {\r\n      left = 10;\r\n    }\r\n    if (left > this.canvasW - 170) {\r\n      left = this.posX - 170;\r\n    }\r\n    return left;\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  ElementRef,\r\n  EventEmitter,\r\n  Input,\r\n  Output,\r\n  Renderer2,\r\n  SimpleChanges,\r\n  ViewChild,\r\n} from '@angular/core';\r\nimport { format } from 'mathjs';\r\nimport { ResizedEvent } from 'angular-resize-event';\r\nimport { Subject, debounceTime } from 'rxjs';\r\nimport { HistogramBarVO } from '../../model/ngx-khiops-histogram.bar-vo';\r\nimport * as d3 from 'd3';\r\nimport {\r\n  HistogramValuesI,\r\n  RangeXLogI,\r\n  RangeXLinI,\r\n  RangeYLogI,\r\n  HistogramOptions,\r\n} from '../../interfaces/ngx-khiops-histogram.interfaces';\r\nimport { HistogramService } from '../../services/ngx-khiops-histogram.service';\r\nimport { HistogramType } from '../../model/ngx-khiops-histogram.types';\r\nimport { HistogramUIService } from '../../services/ngx-khiops-histogram.ui.service';\r\n\r\n@Component({\r\n  selector: 'ngx-khiops-histogram',\r\n  templateUrl: './ngx-khiops-histogram.component.html',\r\n  styleUrl: './ngx-khiops-histogram.component.scss',\r\n  standalone: false,\r\n})\r\nexport class NgxKhiopsHistogramComponent {\r\n  @ViewChild('chart', { static: false })\r\n  chart!: ElementRef;\r\n\r\n  componentType = 'histogram'; // needed to copy datas\r\n  svg: d3.Selection<SVGElement, unknown, HTMLElement, any> | undefined;\r\n  private resizeSubject = new Subject<ResizedEvent>();\r\n\r\n  // Outputs\r\n  @Output() selectedItemChanged: EventEmitter<any> = new EventEmitter();\r\n\r\n  // Dynamic values\r\n  @Input() datas: HistogramValuesI[] | undefined;\r\n  @Input() datasLabels: any;\r\n  @Input() selectedItem: number = 0;\r\n  @Input() graphOptionX: HistogramType | undefined = HistogramType.YLOG;\r\n  @Input() graphOptionY: HistogramType | undefined = HistogramType.YLOG;\r\n  @Input() options: HistogramOptions = {\r\n    selectedBarColor: 'black',\r\n    gridColor: '#e5e5e5',\r\n    xPadding: 40,\r\n    yPadding: 50,\r\n    minBarHeight: 4,\r\n  };\r\n\r\n  h: number = 0;\r\n  w: number = 0;\r\n  bars: HistogramBarVO[] = [];\r\n\r\n  // Static config values\r\n  xTickCount: number = 0;\r\n  yTicksCount = 10;\r\n  tickSize = 0;\r\n\r\n  // selectedBarColor: string =\r\n  //   localStorage.getItem(\r\n  //     AppConfig.visualizationCommon.GLOBAL.LS_ID + 'THEME_COLOR'\r\n  //   ) === 'dark'\r\n  //     ? 'white'\r\n  //     : 'black';\r\n\r\n  // Local variables\r\n  rangeXLog: RangeXLogI | undefined;\r\n  rangeXLin: RangeXLinI | undefined;\r\n  rangeYLin: number | undefined;\r\n  rangeYLog: RangeYLogI | undefined;\r\n\r\n  ratioY = 0;\r\n  ratio: number = 0;\r\n  isLoading: boolean = false;\r\n\r\n  colorSet: string[];\r\n\r\n  ctx: CanvasRenderingContext2D | null | undefined;\r\n  ctxSelected: CanvasRenderingContext2D | null | undefined;\r\n  ctxHover: CanvasRenderingContext2D | null | undefined;\r\n\r\n  histogramCanvas: HTMLCanvasElement | null | undefined;\r\n  histogramHoverCanvas: HTMLCanvasElement | null | undefined;\r\n  histogramSelectedCanvas: HTMLCanvasElement | null | undefined;\r\n\r\n  tooltipText: string = '';\r\n  tooltipPosX: number = 0;\r\n  tooltipPosY: number = 0;\r\n  tooltipDisplay: boolean = false;\r\n\r\n  constructor(\r\n    private histogramService: HistogramService,\r\n    private el: ElementRef,\r\n    private renderer: Renderer2\r\n  ) {\r\n    this.colorSet = HistogramUIService.getColors();\r\n    this.resizeSubject.pipe(debounceTime(100)).subscribe((event) => {\r\n      this.handleResized(event);\r\n    });\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n    this.histogramCanvas = document.getElementById(\r\n      'histogram-canvas'\r\n    ) as HTMLCanvasElement;\r\n    this.histogramSelectedCanvas = document.getElementById(\r\n      'histogram-canvas-selected'\r\n    ) as HTMLCanvasElement;\r\n    this.histogramHoverCanvas = document.getElementById(\r\n      'histogram-canvas-hover'\r\n    ) as HTMLCanvasElement;\r\n    this.histogramSelectedCanvas?.addEventListener(\r\n      'click',\r\n      this.handleCanvasClick.bind(this)\r\n    );\r\n    this.histogramSelectedCanvas?.addEventListener(\r\n      'mousemove',\r\n      this.handleCanvasMove.bind(this)\r\n    );\r\n    this.histogramSelectedCanvas?.addEventListener(\r\n      'mouseout',\r\n      this.handleCanvasOut.bind(this)\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.histogramSelectedCanvas?.removeEventListener(\r\n      'click',\r\n      this.handleCanvasClick.bind(this)\r\n    );\r\n    this.histogramSelectedCanvas?.removeEventListener(\r\n      'mousemove',\r\n      this.handleCanvasMove.bind(this)\r\n    );\r\n    this.histogramSelectedCanvas?.removeEventListener(\r\n      'mouseout',\r\n      this.handleCanvasOut.bind(this)\r\n    );\r\n  }\r\n\r\n  changeGraphTypeX(type: HistogramType) {\r\n    // localStorage.setItem(\r\n    //   this.khiopsLibraryService.getAppConfig().common.GLOBAL.LS_ID +\r\n    //     'DISTRIBUTION_GRAPH_OPTION_X',\r\n    //   type\r\n    // );\r\n    this.graphOptionX = type;\r\n    this.datas && this.init();\r\n  }\r\n\r\n  changeGraphTypeY(type: HistogramType) {\r\n    // localStorage.setItem(\r\n    //   this.khiopsLibraryService.getAppConfig().common.GLOBAL.LS_ID +\r\n    //     'DISTRIBUTION_GRAPH_OPTION_Y',\r\n    //   type\r\n    // );\r\n    this.graphOptionY = type;\r\n    this.datas && this.init();\r\n  }\r\n\r\n  onResized(event: ResizedEvent) {\r\n    this.resizeSubject.next(event);\r\n  }\r\n\r\n  handleResized(event: ResizedEvent) {\r\n    this.h = this.chart.nativeElement.offsetHeight + 10 - 60; // graph header = 60, +10 to take more height\r\n    this.w = this.chart.nativeElement.offsetWidth;\r\n\r\n    // Do it every timesto be sure that chart height has been computed\r\n    this.datas && this.init();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes['options']) {\r\n      console.log(\r\n        'NgxKhiopsHistogramComponent ~ ngOnChanges ~ changes:',\r\n        changes\r\n      );\r\n      this.renderer.setStyle(\r\n        this.el.nativeElement,\r\n        '--chart-border',\r\n        this.options.gridColor\r\n      );\r\n    }\r\n    if (changes['datas'] && !changes['datas'].firstChange) {\r\n      this.datas && this.init();\r\n    }\r\n    if (changes['graphOptionX'] && !changes['graphOptionX'].firstChange) {\r\n      this.datas && this.init();\r\n    }\r\n    if (changes['graphOptionY'] && !changes['graphOptionY'].firstChange) {\r\n      this.datas && this.init();\r\n    }\r\n    if (changes['selectedItem']) {\r\n      this.drawSelectedItem();\r\n    }\r\n  }\r\n\r\n  handleCanvasClick(event: any) {\r\n    const canvasPosition = this.histogramCanvas?.getBoundingClientRect();\r\n    if (this.datas && canvasPosition) {\r\n      const barPosition = HistogramUIService.getCurrentBarPosition(\r\n        this.datas,\r\n        canvasPosition,\r\n        event,\r\n        this.options.yPadding\r\n      );\r\n      if (barPosition !== undefined) {\r\n        this.selectedItem = barPosition;\r\n        this.selectedItemChanged.emit(this.selectedItem);\r\n        this.drawSelectedItem();\r\n      } else {\r\n        // no bar selected\r\n      }\r\n    }\r\n  }\r\n\r\n  drawSelectedItem() {\r\n    HistogramUIService.cleanDomContext(\r\n      this.ctxSelected,\r\n      this.histogramSelectedCanvas\r\n    );\r\n    // reDraw selected item in front of others\r\n    if (this.ctxSelected && this.datas) {\r\n      this.drawRect(\r\n        this.ctxSelected,\r\n        this.datas[this.selectedItem],\r\n        this.bars[this.selectedItem],\r\n        this.ratio,\r\n        true\r\n      );\r\n    }\r\n  }\r\n\r\n  handleCanvasOut() {\r\n    this.hideTooltip();\r\n    HistogramUIService.cleanDomContext(\r\n      this.ctxHover,\r\n      this.histogramHoverCanvas\r\n    );\r\n  }\r\n\r\n  handleCanvasMove(event: any) {\r\n    const canvasPosition = this.histogramCanvas?.getBoundingClientRect();\r\n    if (this.datas && canvasPosition) {\r\n      const barPosition = HistogramUIService.getCurrentBarPosition(\r\n        this.datas,\r\n        canvasPosition,\r\n        event,\r\n        this.options.yPadding\r\n      );\r\n\r\n      if (barPosition !== undefined) {\r\n        const bar = this.datas[barPosition];\r\n        const tooltipText = HistogramUIService.generateTooltip(\r\n          this.datasLabels,\r\n          bar,\r\n          barPosition === 0\r\n        );\r\n        this.showTooltip(event, tooltipText);\r\n\r\n        HistogramUIService.cleanDomContext(\r\n          this.ctxHover,\r\n          this.histogramHoverCanvas\r\n        );\r\n        if (this.ctxHover) {\r\n          this.drawRect(\r\n            this.ctxHover,\r\n            this.datas[barPosition],\r\n            this.bars[barPosition],\r\n            this.ratio\r\n          );\r\n        }\r\n      } else {\r\n        this.hideTooltip();\r\n      }\r\n    }\r\n  }\r\n\r\n  showTooltip(event: MouseEvent, text: string) {\r\n    this.tooltipPosX = event.offsetX + 20;\r\n    this.tooltipPosY = event.offsetY - 40;\r\n    this.tooltipText = text;\r\n    this.tooltipDisplay = true;\r\n  }\r\n\r\n  hideTooltip() {\r\n    this.tooltipDisplay = false;\r\n  }\r\n\r\n  init() {\r\n    console.log('HistogramComponent ~ ngOnInit ~ this.datas:', this.datas);\r\n    if (this.histogramCanvas) {\r\n      HistogramUIService.cleanDomContext(this.ctx, this.histogramCanvas);\r\n      HistogramUIService.cleanDomContext(\r\n        this.ctxHover,\r\n        this.histogramHoverCanvas\r\n      );\r\n      HistogramUIService.cleanDomContext(\r\n        this.ctxSelected,\r\n        this.histogramSelectedCanvas\r\n      );\r\n      this.ctx = HistogramUIService.initCanvasContext(\r\n        this.histogramCanvas,\r\n        this.w,\r\n        this.h\r\n      );\r\n      this.ctxHover = HistogramUIService.initCanvasContext(\r\n        this.histogramHoverCanvas,\r\n        this.w,\r\n        this.h\r\n      );\r\n      this.ctxSelected = HistogramUIService.initCanvasContext(\r\n        this.histogramSelectedCanvas,\r\n        this.w,\r\n        this.h\r\n      );\r\n\r\n      this.xTickCount = 5; // We must reinit each times\r\n\r\n      if (this.chart) {\r\n        this.chart.nativeElement.innerHTML = '';\r\n        if (this.datas) {\r\n          if (this.datas.length > 500) {\r\n            // display loading\r\n            this.isLoading = true;\r\n          }\r\n\r\n          setTimeout(\r\n            () => {\r\n              // const t0 = performance.now();\r\n              if (this.datas) {\r\n                if (this.graphOptionY === HistogramType.YLOG) {\r\n                  this.rangeYLog = this.histogramService.getLogRangeY(\r\n                    this.datas\r\n                  );\r\n                  this.ratioY = this.histogramService.getLogRatioY(\r\n                    this.h,\r\n                    this.options.yPadding\r\n                  );\r\n                } else {\r\n                  this.rangeYLin = this.histogramService.getLinRangeY(\r\n                    this.datas\r\n                  );\r\n                  this.ratioY = this.histogramService.getLinRatioY(\r\n                    this.h,\r\n                    this.options.yPadding\r\n                  );\r\n                }\r\n\r\n                this.drawChart(this.w);\r\n\r\n                [this.rangeXLin, this.rangeXLog] =\r\n                  this.histogramService.getRangeX(this.datas);\r\n\r\n                if (\r\n                  this.rangeXLog.negValuesCount === 0 ||\r\n                  this.rangeXLog.posValuesCount === 0\r\n                ) {\r\n                  this.xTickCount = this.xTickCount * 2;\r\n                }\r\n\r\n                this.drawYAxis();\r\n                this.drawHistogram(this.datas);\r\n\r\n                if (this.graphOptionX === HistogramType.XLIN) {\r\n                  let shift = 0;\r\n                  let width = this.w - 2 * this.options.xPadding;\r\n                  let domain = [this.rangeXLin.min, this.rangeXLin.max];\r\n                  let tickValues = this.datas.map(\r\n                    (e: HistogramValuesI) => e.partition[0]\r\n                  );\r\n                  tickValues.push(\r\n                    this.datas[this.datas.length - 1].partition[1]\r\n                  );\r\n                  // @ts-ignore\r\n                  this.drawXAxis(domain, shift, width);\r\n                } else {\r\n                  // Draw positive axis\r\n                  let shift = 0;\r\n                  let width = 0;\r\n                  let domain: number[] = [];\r\n\r\n                  if (\r\n                    this.rangeXLog.posStart !== this.rangeXLog.max &&\r\n                    this.rangeXLog.posValuesCount\r\n                  ) {\r\n                    width = this.w - 2 * this.options.xPadding;\r\n                    // @ts-ignore\r\n                    domain = [this.rangeXLog.posStart, this.rangeXLog.max];\r\n\r\n                    let shiftInf = 2;\r\n                    if (this.rangeXLog.inf && !this.rangeXLog.negStart) {\r\n                      shiftInf = 1;\r\n                    }\r\n                    if (\r\n                      !this.rangeXLog.inf &&\r\n                      this.rangeXLog.negValuesCount === 0\r\n                    ) {\r\n                      shiftInf = 0; // only positive values\r\n                    }\r\n                    shift +=\r\n                      ((this.w - 2 * this.options.xPadding) / this.ratio) *\r\n                      // @ts-ignore\r\n                      Math.log10(this.rangeXLog.middlewidth) *\r\n                      shiftInf;\r\n\r\n                    if (this.rangeXLog.negValuesCount !== 0) {\r\n                      shift +=\r\n                        ((this.w - 2 * this.options.xPadding) / this.ratio) *\r\n                        // @ts-ignore\r\n                        Math.log10(Math.abs(this.rangeXLog.min));\r\n                      shift -=\r\n                        ((this.w - 2 * this.options.xPadding) / this.ratio) *\r\n                        // @ts-ignore\r\n                        Math.log10(Math.abs(this.rangeXLog.negStart));\r\n                    }\r\n                    width = this.w - 2 * this.options.xPadding - shift;\r\n                    this.drawXAxis(domain, shift, width);\r\n                  }\r\n\r\n                  // Draw -Inf axis\r\n                  if (this.rangeXLog.inf) {\r\n                    if (this.rangeXLog.posValuesCount) {\r\n                      let middleShift =\r\n                        shift -\r\n                        ((this.w - 2 * this.options.xPadding) / this.ratio) *\r\n                          // @ts-ignore\r\n                          Math.log10(this.rangeXLog.middlewidth);\r\n                      domain = [1];\r\n                      this.drawXAxis(domain, middleShift - 1, 1);\r\n                    } else {\r\n                      let middleShift = this.w - 2 * this.options.xPadding;\r\n                      domain = [1];\r\n                      this.drawXAxis(domain, middleShift - 1, 1); // 1 to make bigger line\r\n                    }\r\n                  }\r\n\r\n                  // Draw negative axis\r\n                  if (\r\n                    // this.rangeXLog.inf ||\r\n                    this.rangeXLog.negStart !== this.rangeXLog.min &&\r\n                    this.rangeXLog.negValuesCount\r\n                  ) {\r\n                    width = this.w - 2 * this.options.xPadding - width;\r\n                    // @ts-ignore\r\n                    domain = [this.rangeXLog.min, this.rangeXLog.negStart];\r\n\r\n                    if (this.rangeXLog.posValuesCount) {\r\n                      // If there is pos and neg values\r\n                      width =\r\n                        width -\r\n                        ((this.w - 2 * this.options.xPadding) / this.ratio) *\r\n                          // @ts-ignore\r\n                          Math.log10(this.rangeXLog.middlewidth) *\r\n                          2;\r\n                    } else {\r\n                      if (this.rangeXLog.inf) {\r\n                        width =\r\n                          width -\r\n                          ((this.w - 2 * this.options.xPadding) / this.ratio) *\r\n                            // @ts-ignore\r\n                            Math.log10(this.rangeXLog.middlewidth);\r\n                      }\r\n                    }\r\n                    this.drawXAxis(domain, 0, width);\r\n                  }\r\n                }\r\n                this.drawSelectedItem();\r\n                // const t1 = performance.now();\r\n                // console.log('draw histogram ' + (t1 - t0) + ' milliseconds.');\r\n                this.isLoading = false;\r\n              }\r\n            },\r\n            this.isLoading ? 100 : 0\r\n          );\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  drawChart(chartW: number) {\r\n    //@ts-ignore\r\n    this.svg = d3\r\n      .select(this.chart.nativeElement)\r\n      .append('svg')\r\n      .attr('width', chartW)\r\n      .attr('height', this.h + this.options.yPadding);\r\n  }\r\n\r\n  drawRect(\r\n    ctx: CanvasRenderingContext2D,\r\n    d: HistogramValuesI,\r\n    bar: HistogramBarVO,\r\n    ratio: number = 0,\r\n    selectedItem: boolean = false\r\n  ) {\r\n    if (ctx) {\r\n      let barX: number, barH: number, barW: number;\r\n\r\n      if (this.graphOptionX === HistogramType.XLIN) {\r\n        barX = ((this.w - 2 * this.options.xPadding) / ratio) * bar.barXlin;\r\n        barW = ((this.w - 2 * this.options.xPadding) / ratio) * bar.barWlin;\r\n      } else {\r\n        barX = ((this.w - 2 * this.options.xPadding) / ratio) * bar.barXlog;\r\n        barW = ((this.w - 2 * this.options.xPadding) / ratio) * bar.barWlog;\r\n      }\r\n\r\n      if (this.graphOptionY === HistogramType.YLIN) {\r\n        barH = d.value * this.ratioY;\r\n      } else {\r\n        if (d.logValue !== 0) {\r\n          // @ts-ignore\r\n          let shift = Math.abs(this.rangeYLog.max);\r\n          barH = Math.abs(d.logValue) * this.ratioY - shift * this.ratioY;\r\n          barH = this.h - this.options.yPadding / 2 - barH;\r\n        } else {\r\n          barH = 0;\r\n        }\r\n      }\r\n      if (barH !== 0 && barH < this.options.minBarHeight) {\r\n        barH = this.options.minBarHeight;\r\n      }\r\n      if (this.graphOptionY === HistogramType.YLOG && barH === 0) {\r\n        barH = this.options.minBarHeight;\r\n      }\r\n\r\n      const x = barX + this.options.xPadding + this.options.xPadding / 2;\r\n      const y = this.h - barH;\r\n\r\n      // Tooltip issue on histogram #189\r\n      if (barW < 1) {\r\n        barW = 1.5;\r\n      }\r\n\r\n      // keep current coords to bind clicks and tooltip\r\n      d.coords = {\r\n        x: x,\r\n        y: y,\r\n        barW: barW,\r\n        barH: barH,\r\n      };\r\n\r\n      ctx.fillStyle = HistogramUIService.hexToRgba(bar.color, 0.8);\r\n      ctx.lineWidth = 0;\r\n      ctx.fillRect(x, y, barW, barH);\r\n      ctx.strokeStyle = selectedItem\r\n        ? this.options.selectedBarColor\r\n        : bar.color;\r\n      ctx.lineWidth = selectedItem ? 2 : 1;\r\n      ctx.strokeRect(x, y, barW, barH);\r\n    }\r\n  }\r\n\r\n  drawHistogram(datasSet: HistogramValuesI[]) {\r\n    this.bars = this.histogramService.computeXbarsDimensions(\r\n      datasSet,\r\n      // @ts-ignore\r\n      this.graphOptionX\r\n    );\r\n    this.ratio = 0;\r\n    if (this.graphOptionX === HistogramType.XLIN) {\r\n      this.ratio =\r\n        this.bars[this.bars.length - 1].barXlin +\r\n        this.bars[this.bars.length - 1].barWlin;\r\n    } else {\r\n      this.ratio =\r\n        this.bars[this.bars.length - 1].barXlog +\r\n        this.bars[this.bars.length - 1].barWlog;\r\n    }\r\n\r\n    datasSet.forEach((d: HistogramValuesI, i: number) => {\r\n      // @ts-ignore\r\n      this.drawRect(this.ctx, d, this.bars[i], this.ratio);\r\n    });\r\n  }\r\n\r\n  drawXAxis(domain: number[], shift: number, width: number) {\r\n    if (width !== 0) {\r\n      let xAxis;\r\n      shift = shift + this.options.xPadding;\r\n\r\n      if (this.graphOptionX === HistogramType.XLIN) {\r\n        xAxis = d3.scaleLinear().domain(domain).range([0, width]); // This is where the axis is placed: from 100px to 800px\r\n      } else {\r\n        xAxis = d3.scaleLog().base(10).domain(domain).range([0, width]);\r\n      }\r\n\r\n      //@ts-ignore\r\n      const axis: d3.Axis<d3.NumberValue> = d3\r\n        .axisBottom(xAxis)\r\n        .ticks([this.xTickCount])\r\n        .tickArguments([this.xTickCount, '.0e'])\r\n        .tickSize(-this.h + this.options.yPadding / 2);\r\n\r\n      if (this.graphOptionX === HistogramType.XLIN) {\r\n        //@ts-ignore\r\n        axis.tickFormat((d: number) => {\r\n          let val: any = d;\r\n          return '' + format(val);\r\n        });\r\n      }\r\n\r\n      this.svg!.insert('g', ':first-child')\r\n        .attr('class', 'barXlog axis-grid')\r\n        .attr(\r\n          'transform',\r\n          'translate(' +\r\n            (shift + this.options.xPadding / 2) +\r\n            ',' +\r\n            this.h +\r\n            ') '\r\n        ) // This controls the vertical position of the Axis\r\n        .call(axis)\r\n        .selectAll('text')\r\n        .style('text-anchor', 'end')\r\n        .attr('dx', '-0.4em')\r\n        .attr('dy', '1em')\r\n        .attr('transform', 'rotate(-35)');\r\n\r\n      d3.selectAll('line').style('stroke', this.options.gridColor); // Set the grid color\r\n    }\r\n  }\r\n\r\n  drawYAxis() {\r\n    let y;\r\n\r\n    // Create the scale\r\n    if (this.graphOptionY === HistogramType.YLIN) {\r\n      y = d3\r\n        .scaleLinear()\r\n        // @ts-ignore\r\n        .domain([0, this.rangeYLin]) // This is what is written on the Axis: from 0 to 100\r\n        .range([this.h - this.options.yPadding / 2, 0]); // Note it is reversed\r\n    } else {\r\n      y = d3\r\n        .scaleLinear()\r\n        // @ts-ignore\r\n        .domain([this.rangeYLog.max, this.rangeYLog.min]) // This is what is written on the Axis: from 0 to 100\r\n        .range([0, this.h - this.options.yPadding / 2]); // Note it is reversed\r\n    }\r\n\r\n    let shift = this.options.xPadding;\r\n    this.tickSize = -(this.w - this.options.xPadding * 2);\r\n\r\n    // Draw the axis\r\n    const axis = d3\r\n      .axisLeft(y)\r\n      .tickSize(this.tickSize)\r\n      .tickPadding(10)\r\n      // @ts-ignore\r\n      .tickFormat((d: number) => {\r\n        let val: number = d;\r\n        if (this.graphOptionY === HistogramType.YLIN) {\r\n          return '' + format(val);\r\n        } else {\r\n          const antiLog = Math.pow(10, val);\r\n          return d3.format('.0e')(antiLog);\r\n        }\r\n      })\r\n\r\n      .ticks(this.yTicksCount);\r\n    // @ts-ignore\r\n    this.svg\r\n      .append('g')\r\n      .attr('class', 'y axis-grid')\r\n      .attr(\r\n        'transform',\r\n        'translate(' +\r\n          (shift + this.options.xPadding / 2) +\r\n          ',' +\r\n          this.options.yPadding / 2 +\r\n          ')'\r\n      ) // This controls the vertical position of the Axis\r\n      .call(axis)\r\n      .selectAll('line')\r\n      .style('stroke', this.options.gridColor); // Set the grid color\r\n  }\r\n}\r\n","<div class=\"app-histogram\" fxFlexFill (resized)=\"onResized($event)\">\r\n  <canvas id=\"histogram-canvas\" fxFlex> </canvas>\r\n  <canvas id=\"histogram-canvas-hover\" fxFlex> </canvas>\r\n  <canvas id=\"histogram-canvas-selected\" fxFlex> </canvas>\r\n  <div #chart id=\"histogram-chart\"></div>\r\n  <ngx-khiops-histogram-tooltip\r\n    [text]=\"tooltipText\"\r\n    [canvasW]=\"w\"\r\n    [posX]=\"tooltipPosX\"\r\n    [posY]=\"tooltipPosY\"\r\n    [display]=\"tooltipDisplay\"\r\n  >\r\n  </ngx-khiops-histogram-tooltip>\r\n</div>\r\n","import { NgModule } from '@angular/core';\r\nimport { NgxKhiopsHistogramComponent } from './components/histogram/ngx-khiops-histogram.component';\r\nimport { CommonModule } from '@angular/common';\r\nimport { NgxKhiopsHistogramTooltipComponent } from './components/tooltip/ngx-khiops-histogram.tooltip.component';\r\nimport { AngularResizeEventModule } from 'angular-resize-event';\r\n\r\n@NgModule({\r\n  imports: [CommonModule, AngularResizeEventModule],\r\n  declarations: [\r\n    NgxKhiopsHistogramComponent,\r\n    NgxKhiopsHistogramTooltipComponent,\r\n  ],\r\n  exports: [NgxKhiopsHistogramComponent, NgxKhiopsHistogramTooltipComponent],\r\n})\r\nexport class NgxKhiopsHistogramModule {}\r\n","/*\r\n * Public API Surface of ngx-khiops-histogram\r\n */\r\n\r\nexport * from './lib/services/ngx-khiops-histogram.service';\r\nexport * from './lib/components/histogram/ngx-khiops-histogram.component';\r\nexport * from './lib/components/tooltip/ngx-khiops-histogram.tooltip.component';\r\nexport * from './lib/ngx-khiops-histogram.module';\r\nexport * from './lib/interfaces/ngx-khiops-histogram.interfaces';\r\nexport * from './lib/model/ngx-khiops-histogram.types';\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["i1.HistogramService","i3.NgxKhiopsHistogramTooltipComponent"],"mappings":"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"}